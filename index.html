<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clash Royale SQL Arena - –í—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã</title>
    
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="choose-team">
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω -->
    <div class="sparkles"></div>
    
    <div class="choose-container">
        <h1 class="glitch-title" data-text="CLASH ROYALE SQL ARENA">CLASH ROYALE SQL ARENA</h1>
        
        <div class="team-cards">
            <!-- –ö—Ä–∞—Å–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ -->
            <div class="team-card red-team" onclick="selectTeam('red')">
                <div class="team-glow"></div>
                <div class="team-emoji">üî¥</div>
                <h2>–ö–†–ê–°–ù–ê–Ø –ë–ê–®–ù–Ø</h2>
                <div class="team-stats" id="redStats">
                    <div class="stat"><span class="stat-label">–ö–ª–∞–Ω—ã:</span> <span class="stat-value" id="redClansStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ò–≥—Ä–æ–∫–∏:</span> <span class="stat-value" id="redPlayersStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ö–∞—Ä—Ç—ã:</span> <span class="stat-value" id="redCardsStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ë–∏—Ç–≤—ã:</span> <span class="stat-value" id="redBattlesStat">0</span></div>
                </div>
                <div class="team-total" id="redTotal">üèÜ 0</div>
                <button class="choose-btn red" onclick="event.stopPropagation(); enterBattle('red')">
                    <i class="fas fa-sword"></i> –í–û–ô–¢–ò –í –ë–ò–¢–í–£
                </button>
            </div>
            
            <!-- –°–∏–Ω—è—è –∫–æ–º–∞–Ω–¥–∞ -->
            <div class="team-card blue-team" onclick="selectTeam('blue')">
                <div class="team-glow"></div>
                <div class="team-emoji">üîµ</div>
                <h2>–°–ò–ù–Ø–Ø –ë–ê–®–ù–Ø</h2>
                <div class="team-stats" id="blueStats">
                    <div class="stat"><span class="stat-label">–ö–ª–∞–Ω—ã:</span> <span class="stat-value" id="blueClansStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ò–≥—Ä–æ–∫–∏:</span> <span class="stat-value" id="bluePlayersStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ö–∞—Ä—Ç—ã:</span> <span class="stat-value" id="blueCardsStat">0</span></div>
                    <div class="stat"><span class="stat-label">–ë–∏—Ç–≤—ã:</span> <span class="stat-value" id="blueBattlesStat">0</span></div>
                </div>
                <div class="team-total" id="blueTotal">üèÜ 0</div>
                <button class="choose-btn blue" onclick="event.stopPropagation(); enterBattle('blue')">
                    <i class="fas fa-sword"></i> –í–û–ô–¢–ò –í –ë–ò–¢–í–£
                </button>
            </div>
        </div>
        
        <div class="arena-info">
            <div class="info-item">
                <i class="fas fa-database"></i>
                <span>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ SQL</span>
            </div>
            <div class="info-item">
                <i class="fas fa-trophy"></i>
                <span>1 –∫—É–±–æ–∫ = 1 –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞</span>
            </div>
            <div class="info-item">
                <i class="fas fa-users"></i>
                <span>–°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ –¥–≤—É—Ö –∫–æ–º–∞–Ω–¥</span>
            </div>
        </div>
    </div>
    
    <script src="app.js"></script>
    <script>
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('load', () => {
            loadTeamStats('red');
            loadTeamStats('blue');
        });
        
        function selectTeam(team) {
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞
            document.querySelectorAll('.team-card').forEach(c => c.classList.remove('selected'));
            document.querySelector(`.${team}-team`).classList.add('selected');
        }
        
        function enterBattle(team) {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–æ–º–∞–Ω–¥—É –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –∞—Ä–µ–Ω—É
            localStorage.setItem('selectedTeam', team);
            window.location.href = 'battle.html';
        }
        
        async function loadTeamStats(team) {
            const files = ['clans', 'players', 'cards', 'battles'];
            
            for (const file of files) {
                try {
                    const response = await fetch(`teams/${team}/${file}.sql`);
                    const content = await response.text();
                    
                    // –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—á–µ—Ç –∫–æ–ª–æ–Ω–æ–∫ (–±—É–¥–µ—Ç —É–ª—É—á—à–µ–Ω –≤ battle.js)
                    const columns = countColumns(content);
                    document.getElementById(`${team}${file.charAt(0).toUpperCase() + file.slice(1)}Stat`).textContent = columns;
                    
                } catch (error) {
                    document.getElementById(`${team}${file.charAt(0).toUpperCase() + file.slice(1)}Stat`).textContent = '0';
                }
            }
            
            updateTeamTotal(team);
        }
        
        function countColumns(sql) {
            // –í—Ä–µ–º–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–≤—å—é
            const match = sql.match(/CREATE TABLE.*?\((.*?)\)/s);
            if (match) {
                const columns = match[1].split(',').filter(col => 
                    !col.trim().toLowerCase().startsWith('foreign key')
                );
                return columns.length;
            }
            return 0;
        }
        
        function updateTeamTotal(team) {
            let total = 0;
            const stats = document.querySelectorAll(`#${team}Stats .stat-value`);
            stats.forEach(stat => {
                total += parseInt(stat.textContent) || 0;
            });
            document.getElementById(`${team}Total`).innerHTML = `üèÜ ${total}`;
        }
    </script>
</body>
</html>
